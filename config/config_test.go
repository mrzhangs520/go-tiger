package config

import (
	"fmt"
	"github.com/davecgh/go-spew/spew"
	"github.com/go-resty/resty/v2"
	"testing"
	"time"
)

func TestClient(t *testing.T) {
	jsonString := `{
    "errorMsg":"(surface.Render.elementImage.ResizeImage) bad parameter value: rows=0",
    "param":{
        "coat_img":"",
        "coat_name":"",
        "elementList":[
            {
                "adaptiveType":"width",
                "arrange":"horizontal-tb",
                "color":"",
                "content":"",
                "flip":0,
                "fontFamily":"beifang",
                "height":30.46166666666667,
                "img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/023af2c7-0e22-455a-9dda-c2e74e8e0b3f.png",
                "lock":false,
                "modeType":"图片",
                "original_img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/023af2c7-0e22-455a-9dda-c2e74e8e0b3f.png",
                "rotate":0,
                "type":"",
                "width":92.62833333333334,
                "x_left":42,
                "x_right":409,
                "y_bottom":313.577,
                "y_top":237.423
            },
            {
                "adaptiveType":"width",
                "arrange":"horizontal-tb",
                "color":"",
                "content":"千年传雅韵 一品醉知音",
                "flip":0,
                "fontFamily":"FZHDJT",
                "height":6.610806916426513,
                "img":"https://produce01.xiyin.love/xxBoxImg/wordImgs/622eb71db5ea1.png",
                "modeType":"文本",
                "original_img":"https://produce01.xiyin.love/xxBoxImg/wordImgs/622eb71db5ea1.png",
                "rotate":0,
                "type":"sub_title",
                "width":83.92500000000001,
                "x_left":91.2258,
                "x_right":373.7742,
                "y_bottom":256.209,
                "y_top":331.791
            },
            {
                "adaptiveType":"width",
                "arrange":"horizontal-tb",
                "color":"",
                "content":"",
                "flip":0,
                "fontFamily":"beifang",
                "height":4.973333333333334,
                "img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/7c09f32b-c246-4b9e-a474-27c75bc60cf0.png",
                "modeType":"图片",
                "original_img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/7c09f32b-c246-4b9e-a474-27c75bc60cf0.png",
                "rotate":0,
                "type":"",
                "width":74.60000000000001,
                "x_left":95,
                "x_right":385,
                "y_bottom":219.33300000000003,
                "y_top":372.667
            },
            {
                "adaptiveType":"width",
                "arrange":"horizontal-tb",
                "color":"",
                "content":"",
                "flip":0,
                "fontFamily":"beifang",
                "height":0.6216666666666667,
                "img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/a29ff25a-8a59-4d40-951b-83e1c87432ec.png",
                "modeType":"图片",
                "original_img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/a29ff25a-8a59-4d40-951b-83e1c87432ec.png",
                "rotate":0,
                "type":"",
                "width":14.298333333333334,
                "x_left":62,
                "x_right":515,
                "y_bottom":262.885,
                "y_top":336.115
            },
            {
                "adaptiveType":"width",
                "arrange":"horizontal-tb",
                "color":"",
                "content":"",
                "flip":0,
                "fontFamily":"beifang",
                "height":0.6216666666666667,
                "img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/1d5b7107-d4ae-41d8-a408-c6ae2faf138e.png",
                "modeType":"图片",
                "original_img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/1d5b7107-d4ae-41d8-a408-c6ae2faf138e.png",
                "rotate":0,
                "type":"",
                "width":12.433333333333334,
                "x_left":232,
                "x_right":348,
                "y_bottom":262.404,
                "y_top":336.596
            },
            {
                "adaptiveType":"width",
                "arrange":"horizontal-tb",
                "color":"#333333",
                "content":"",
                "flip":0,
                "fontFamily":"beifang",
                "gd_original_img":"https://gd-filems.dancf.com/gaoding/gaoding/21716/5a612158-7aa0-4f73-a57e-08dd4666cac41948293.png",
                "height":23.623333333333335,
                "img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logoColor/6225be3d44b3c.png",
                "modeType":"图片",
                "original_img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/4d6463b0-6520-4d1c-a74d-2ff41728ead0.png",
                "rotate":0,
                "type":"",
                "width":48.49,
                "x_left":202,
                "x_right":320,
                "y_bottom":319.93399999999997,
                "y_top":242.066
            },
            {
                "adaptiveType":"width",
                "arrange":"horizontal-tb",
                "color":"",
                "content":"",
                "flip":0,
                "fontFamily":"beifang",
                "height":18.650000000000002,
                "img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/f05a6b32-2e77-44aa-a6d6-8010fae39eba.png",
                "modeType":"图片",
                "original_img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/f05a6b32-2e77-44aa-a6d6-8010fae39eba.png",
                "rotate":0,
                "type":"logo",
                "width":16.785,
                "x_left":53,
                "x_right":520,
                "y_bottom":492.652,
                "y_top":77.348
            },
            {
                "adaptiveType":"width",
                "arrange":"horizontal-tb",
                "color":"",
                "content":"",
                "flip":0,
                "fontFamily":"beifang",
                "height":136.76666666666668,
                "img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/b79d6463-bc40-4761-910f-8511b8141c14.png",
                "modeType":"图片",
                "original_img":"https://baiyin-produce.oss-cn-hangzhou.aliyuncs.com/logo/b79d6463-bc40-4761-910f-8511b8141c14.png",
                "rotate":0,
                "type":"",
                "width":175.31,
                "x_left":286,
                "x_right":32,
                "y_bottom":65.94,
                "y_top":314.06
            }
        ],
        "height":263,
        "multiple":5,
        "spu_id":100227,
        "surface_group":"外部",
        "surface_icon":"https://produce01.xiyin.love/newbox/static/icon/飞机盒视图/上面.png",
        "surface_name":"上面",
        "template_id":25,
        "width":373
    },
    "requestUrl":"/api/image/renderSurface"
}`
	times := 1
	for {
		// 调用接口
		resp, err := resty.
			New().
			SetTimeout(10*time.Second).
			R().
			SetHeader("Content-Type", "application/json").
			SetBody([]byte(jsonString)).
			Post("http://127.0.0.1:8080/api/image/renderSurface")
		if nil != err {
			spew.Dump(err)
		}
		fmt.Printf("%d:%s\n", times, string(resp.Body()))
		times++
	}
}
